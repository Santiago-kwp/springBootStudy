import{u as v,h as g,c as k,y as _,b as a,e as t,t as n,F as h,i as w,f as x,k as l,v as i,z as c,j as N,a as S,o as d}from"./index-CAEnLQrx.js";import{a as I}from"./orderService-DTFPsb9K.js";import{g as V}from"./cartService-Db-1dUZh.js";const M={class:"container"},U={class:"row g-5"},L={class:"col-md-5 col-lg-4 order-md-last"},j={class:"mb-3"},B={class:"badge bg-primary rounded-pill align-middle"},D={class:"items list-group mb-3"},F={class:"p-3 list-group-item d-flex justify-content-between"},P={class:"my-0"},R={class:"text-muted"},q={class:"border p-4 bg-light h5 rounded text-center total-price"},C={class:"col-md-7 col-lg-8"},E={class:"row g-3"},O={class:"col-12"},T={class:"col-12 pt-1"},z={class:"my-3"},A={class:"form-check"},$={class:"form-check"},G={key:0,class:"pt-1"},W={__name:"OrderForm",setup(H){const m=_(),p=v(),f=S(),e=g({items:[],form:{name:p.user.name,address:"",payment:"card",cardNumber:""}}),u=k(()=>{let r=0;return e.items.forEach(s=>{r+=s.price-s.price*s.discountPer/100}),r}),b=async()=>{if(e.form.payment!=="card"&&(e.form.cardNumber=""),e.form.itemIds=e.items.map(s=>s.id),(await I(e.form)).status===200){const s=["주문이 완료되었습니다."];if(e.form.payment==="bank"){const o=u.value.toLocaleString();s.push(`한국은행 123-456789-777 계좌로 ${o}원을 입금해주시기 바랍니다.`)}window.alert(s.join(`
`)),await f.push("/")}};return async function(){const s=m.query.itemIds?m.query.itemIds.split(","):[];if(s.length===0){console.error("주문할 상품 ID가 없습니다.");return}const o=await V();o.status===200&&(e.items=o.data.filter(y=>s.includes(String(y.id))))}(),(r,s)=>(d(),a("form",{class:"order-form",onSubmit:N(b,["prevent"])},[t("div",M,[s[15]||(s[15]=t("div",{class:"py-5 text-center"},[t("div",{class:"h4"},[t("b",null,"주문하기")]),t("p",{class:"h6 font-lg mt-3"},"주문 내역을 확인하시고 주문하기 버튼을 클릭해주세요")],-1)),t("div",U,[t("div",L,[t("div",j,[s[5]||(s[5]=t("span",{class:"h5 mb-3 align-middle me-2"},[t("b",null,"구입 목록")],-1)),t("span",B,n(e.items.length),1)]),t("ul",D,[(d(!0),a(h,null,w(e.items,o=>(d(),a("li",F,[t("div",null,[t("h6",P,n(o.name),1)]),t("span",R,n((o.price-o.price*o.discountPer/100).toLocaleString())+"원 ",1)]))),256))]),t("div",q,[s[6]||(s[6]=t("span",null,"합계 ",-1)),t("b",null,n(u.value.toLocaleString())+"원",1)]),s[7]||(s[7]=t("button",{type:"submit",class:"w-100 btn btn-primary py-4 mt-4"},"결제하기",-1))]),t("div",C,[s[13]||(s[13]=t("div",{class:"h5 mb-3"},[t("b",null,"주문자 정보")],-1)),t("div",E,[t("div",O,[s[8]||(s[8]=t("label",{for:"name",class:"form-label"},"이름",-1)),l(t("input",{type:"text",class:"form-control p-3",id:"name","onUpdate:modelValue":s[0]||(s[0]=o=>e.form.name=o)},null,512),[[i,e.form.name]])]),t("div",T,[s[9]||(s[9]=t("label",{for:"address",class:"form-label"},"주소",-1)),l(t("input",{type:"text",class:"form-control p-3",id:"address","onUpdate:modelValue":s[1]||(s[1]=o=>e.form.address=o)},null,512),[[i,e.form.address]])])]),s[14]||(s[14]=t("div",{class:"h5 mt-5 mb-3"},[t("b",null,"결제 수단")],-1)),t("div",z,[t("div",A,[l(t("input",{id:"card",name:"paymentMethod",type:"radio",class:"form-check-input",value:"card","onUpdate:modelValue":s[2]||(s[2]=o=>e.form.payment=o)},null,512),[[c,e.form.payment]]),s[10]||(s[10]=t("label",{class:"form-check-label",for:"card"},"신용카드",-1))]),t("div",$,[l(t("input",{id:"bank",name:"paymentMethod",type:"radio",class:"form-check-input",value:"bank","onUpdate:modelValue":s[3]||(s[3]=o=>e.form.payment=o)},null,512),[[c,e.form.payment]]),s[11]||(s[11]=t("label",{class:"form-check-label",for:"bank"},"무통장입금",-1))])]),e.form.payment==="card"?(d(),a("div",G,[s[12]||(s[12]=t("label",{for:"cardNum",class:"form-label"},"카드 번호",-1)),l(t("input",{type:"text",class:"form-control p-3",id:"cardNum","onUpdate:modelValue":s[4]||(s[4]=o=>e.form.cardNumber=o)},null,512),[[i,e.form.cardNumber]])])):x("",!0)])])])],32))}};export{W as default};
